/*!
 * Copyright 2016 Amazon.com,
 * Inc. or its affiliates. All Rights Reserved.
 * 
 * Licensed under the Amazon Software License (the "License").
 * You may not use this file except in compliance with the
 * License. A copy of the License is located at
 * 
 *     http://aws.amazon.com/asl/
 * 
 * or in the "license" file accompanying this file. This file is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, express or implied. See the License
 * for the specific language governing permissions and
 * limitations under the License. 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("sjcl"),require("fs"),require("util"),require("aws-sdk/clients/cognitoidentityserviceprovider"),require("jsbn"),require("assert"),require("constants"),require("events"),require("path"),require("stream")):"function"==typeof define&&define.amd?define(["sjcl","fs","util","aws-sdk/clients/cognitoidentityserviceprovider","jsbn","assert","constants","events","path","stream"],t):"object"==typeof exports?exports.AmazonCognitoIdentity=t(require("sjcl"),require("fs"),require("util"),require("aws-sdk/clients/cognitoidentityserviceprovider"),require("jsbn"),require("assert"),require("constants"),require("events"),require("path"),require("stream")):e.AmazonCognitoIdentity=t(e.sjcl,e.fs,e.util,e.AWSCognito.CognitoIdentityServiceProvider,e,e.assert,e.constants,e.events,e.path,e.stream)}(this,function(e,t,n,i,r,s,o,a,u,c){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(19);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var o=n(15),a=r(o),u=i(s);Object.keys(u).forEach(function(e){a["default"][e]=u[e]})},function(t,n){t.exports=e},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),a=i(o),u=n(16),c="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",l="userAttributes.",h=function(){function e(t,n){r(this,e),this.N=new u.BigInteger(c,16),this.g=new u.BigInteger("2"),this.k=new u.BigInteger(this.hexHash("00"+this.N.toString(16)+"0"+this.g.toString(16)),16),this.paranoia=n,this.smallAValue=this.generateRandomSmallA(),this.largeAValue=this.calculateA(this.smallAValue),this.infoBits=a.codec.utf8String.toBits("Caldera Derived Key"),this.poolName=t}return s(e,[{key:"getSmallAValue",value:function(){return this.smallAValue}},{key:"getLargeAValue",value:function(){return this.largeAValue}},{key:"generateRandomSmallA",value:function(){var e=a.random.randomWords(32,this.paranoia),t=a.codec.hex.fromBits(e),n=new u.BigInteger(t,16),i=n.mod(this.N);return i}},{key:"generateRandomString",value:function(){var e=a.random.randomWords(10,this.paranoia),t=a.codec.base64.fromBits(e);return t}},{key:"getRandomPassword",value:function(){return this.randomPassword}},{key:"getSaltDevices",value:function(){return this.SaltToHashDevices}},{key:"getVerifierDevices",value:function(){return this.verifierDevices}},{key:"generateHashDevice",value:function(e,t){this.randomPassword=this.generateRandomString();var n=""+e+t+":"+this.randomPassword,i=this.hash(n),r=a.random.randomWords(4,this.paranoia),s=a.codec.hex.fromBits(r),o=new u.BigInteger(s,16),c=o.toString(16)[0];this.SaltToHashDevices=o.toString(16),o.toString(16).length%2===1?this.SaltToHashDevices="0"+this.SaltToHashDevices:"89ABCDEFabcdef".indexOf(c)!==-1&&(this.SaltToHashDevices="00"+this.SaltToHashDevices);var l=this.g.modPow(new u.BigInteger(this.hexHash(this.SaltToHashDevices+i),16),this.N),h=l.toString(16)[0];this.verifierDevices=l.toString(16),l.toString(16).length%2===1?this.verifierDevices="0"+this.verifierDevices:"89ABCDEFabcdef".indexOf(h)!==-1&&(this.verifierDevices="00"+this.verifierDevices)}},{key:"calculateA",value:function(e){var t=this.g.modPow(e,this.N);if("0"===t.mod(this.N).toString())throw new Error("Illegal paramater. A mod N cannot be 0.");return t}},{key:"calculateU",value:function(e,t){var n=e.toString(16)[0],i=t.toString(16)[0],r=e.toString(16),s=t.toString(16);e.toString(16).length%2===1?r="0"+r:"89ABCDEFabcdef".indexOf(n)!==-1&&(r="00"+r),t.toString(16).length%2===1?s="0"+s:"89ABCDEFabcdef".indexOf(i)!==-1&&(s="00"+s),this.UHexHash=this.hexHash(r+s);var o=new u.BigInteger(this.UHexHash,16);return o}},{key:"hash",value:function(e){var t=a.codec.hex.fromBits(a.hash.sha256.hash(e));return new Array(64-t.length).join("0")+t}},{key:"hexHash",value:function(e){var t=a.codec.hex.fromBits(a.hash.sha256.hash(a.codec.hex.toBits(e)));return new Array(64-t.length).join("0")+t}},{key:"computehkdf",value:function(e,t){var n=new a.misc.hmac(t,a.hash.sha256);n.update(e);var i=n.digest(),r=new a.misc.hmac(i,a.hash.sha256),s=a.bitArray.concat(this.infoBits,a.codec.utf8String.toBits(String.fromCharCode(1)));return r.update(s),a.bitArray.clamp(r.digest(),128)}},{key:"getPasswordAuthenticationKey",value:function(e,t,n,i){if(n.mod(this.N).equals(new u.BigInteger("0",16)))throw new Error("B cannot be zero.");if(this.UValue=this.calculateU(this.largeAValue,n),this.UValue.equals(new u.BigInteger("0",16)))throw new Error("U cannot be zero.");var r=""+this.poolName+e+":"+t,s=this.hash(r),o=i.toString(16)[0],c=i.toString(16);i.toString(16).length%2===1?c="0"+c:"89ABCDEFabcdef".indexOf(o)!==-1&&(c="00"+c);var l=new u.BigInteger(this.hexHash(c+s),16),h=this.g.modPow(l,this.N),f=n.subtract(this.k.multiply(h)),d=f.modPow(this.smallAValue.add(this.UValue.multiply(l)),this.N).mod(this.N),g=d.toString(16),v=d.toString(16)[0];d.toString(16).length%2===1?g="0"+g:"89ABCDEFabcdef".indexOf(v)!==-1&&(g="00"+g);var p=this.UHexHash,y=this.UHexHash[0];this.UHexHash.length%2===1?p="0"+p:this.UHexHash.length%2===0&&"89ABCDEFabcdef".indexOf(y)!==-1&&(p="00"+p);var m=this.computehkdf(a.codec.hex.toBits(g),a.codec.hex.toBits(p));return m}},{key:"getNewPasswordRequiredChallengeUserAttributePrefix",value:function(){return l}}]),e}();t["default"]=h},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),a=i(o),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.AccessToken;r(this,e),this.jwtToken=n||""}return s(e,[{key:"getJwtToken",value:function(){return this.jwtToken}},{key:"getExpiration",value:function(){var e=this.jwtToken.split(".")[1],t=JSON.parse(a.codec.utf8String.fromBits(a.codec.base64url.toBits(e)));return t.exp}}]),e}();t["default"]=u},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),a=i(o),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.IdToken;r(this,e),this.jwtToken=n||""}return s(e,[{key:"getJwtToken",value:function(){return this.jwtToken}},{key:"getExpiration",value:function(){var e=this.jwtToken.split(".")[1],t=JSON.parse(a.codec.utf8String.fromBits(a.codec.base64url.toBits(e)));return t.exp}}]),e}();t["default"]=u},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.RefreshToken;n(this,e),this.token=i||""}return i(e,[{key:"getToken",value:function(){return this.token}}]),e}();t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(1),u=r(a),c=n(16),l=n(11),h=n(3),f=i(h),d=n(4),g=i(d),v=n(5),p=i(v),y=n(6),m=i(y),S=n(9),w=i(S),C=n(10),k=i(C),A=n(8),E=i(A),U=function(){function e(t){if(s(this,e),null==t||null==t.Username||null==t.Pool)throw new Error("Username and pool information are required.");this.username=t.Username||"",this.pool=t.Pool,this.Session=null,this.client=t.Pool.client,this.signInUserSession=null,this.authenticationFlowType="USER_SRP_AUTH",this.localStorage=new l.LocalStorage("./.scratch")}return o(e,[{key:"getSignInUserSession",value:function(){return this.signInUserSession}},{key:"getUsername",value:function(){return this.username}},{key:"getAuthenticationFlowType",value:function(){return this.authenticationFlowType}},{key:"setAuthenticationFlowType",value:function(e){this.authenticationFlowType=e}},{key:"authenticateUser",value:function(e,t){var n=this,i=new f["default"](this.pool.getUserPoolId().split("_")[1],this.pool.getParanoia()),r=new k["default"],s=void 0,o=void 0,a={};null!=this.deviceKey&&(a.DEVICE_KEY=this.deviceKey),a.USERNAME=this.username,a.SRP_A=i.getLargeAValue().toString(16),"CUSTOM_AUTH"===this.authenticationFlowType&&(a.CHALLENGE_NAME="SRP_A"),this.client.makeUnauthenticatedRequest("initiateAuth",{AuthFlow:this.authenticationFlowType,ClientId:this.pool.getClientId(),AuthParameters:a,ClientMetadata:e.getValidationData()},function(a,l){if(a)return t.onFailure(a);var h=l.ChallengeParameters;n.username=h.USER_ID_FOR_SRP,s=new c.BigInteger(h.SRP_B,16),o=new c.BigInteger(h.SALT,16),n.getCachedDeviceKeyAndPassword();var f=i.getPasswordAuthenticationKey(n.username,e.getPassword(),s,o),d=u.codec.base64.toBits(h.SECRET_BLOCK),g=new u.misc.hmac(f,u.hash.sha256);g.update(u.codec.utf8String.toBits(n.pool.getUserPoolId().split("_")[1])),g.update(u.codec.utf8String.toBits(n.username)),g.update(d);var v=r.getNowString();g.update(u.codec.utf8String.toBits(v));var p=g.digest(),y=u.codec.base64.fromBits(p),m={};m.USERNAME=n.username,m.PASSWORD_CLAIM_SECRET_BLOCK=h.SECRET_BLOCK,m.TIMESTAMP=v,m.PASSWORD_CLAIM_SIGNATURE=y,null!=n.deviceKey&&(m.DEVICE_KEY=n.deviceKey),n.client.makeUnauthenticatedRequest("respondToAuthChallenge",{ChallengeName:"PASSWORD_VERIFIER",ClientId:n.pool.getClientId(),ChallengeResponses:m,Session:l.Session},function(e,r){if(e)return t.onFailure(e);var s=r.ChallengeName;if("NEW_PASSWORD_REQUIRED"===s){n.Session=r.Session;var o=null,a=null,u=[],c=i.getNewPasswordRequiredChallengeUserAttributePrefix();if(r.ChallengeParameters&&(o=JSON.parse(r.ChallengeParameters.userAttributes),a=JSON.parse(r.ChallengeParameters.requiredAttributes)),a)for(var l=0;l<a.length;l++)u[l]=a[l].substr(c.length);return t.newPasswordRequired(o,u)}return n.authenticateUserInternal(r,i,t)})})}},{key:"authenticateUserInternal",value:function(e,t,n){var i=this,r=e.ChallengeName;if("SMS_MFA"===r)return this.Session=e.Session,n.mfaRequired(r);if("CUSTOM_CHALLENGE"===r)return this.Session=e.Session,n.customChallenge(e.ChallengeParameters);if("DEVICE_SRP_AUTH"===r)return void this.getDeviceResponse(n);this.signInUserSession=this.getCognitoUserSession(e.AuthenticationResult),this.cacheTokens();var s=e.AuthenticationResult.NewDeviceMetadata;if(null==s)return n.onSuccess(this.signInUserSession);t.generateHashDevice(e.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,e.AuthenticationResult.NewDeviceMetadata.DeviceKey);var o={Salt:u.codec.base64.fromBits(u.codec.hex.toBits(t.getSaltDevices().toString(16))),PasswordVerifier:u.codec.base64.fromBits(u.codec.hex.toBits(t.getVerifierDevices().toString(16)))};this.verifierDevices=u.codec.base64.fromBits(t.getVerifierDevices()),this.deviceGroupKey=s.DeviceGroupKey,this.randomPassword=t.getRandomPassword(),this.client.makeUnauthenticatedRequest("confirmDevice",{DeviceKey:s.DeviceKey,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:o,DeviceName:navigator.userAgent},function(t,r){return t?n.onFailure(t):(i.deviceKey=e.AuthenticationResult.NewDeviceMetadata.DeviceKey,i.cacheDeviceKeyAndPassword(),r.UserConfirmationNecessary===!0?n.onSuccess(i.signInUserSession,r.UserConfirmationNecessary):n.onSuccess(i.signInUserSession))})}},{key:"completeNewPasswordChallenge",value:function(e,t,n){var i=this;if(!e)return n.onFailure("New password is required.");var r=new f["default"](this.pool.getUserPoolId().split("_")[1],this.pool.getParanoia()),s=r.getNewPasswordRequiredChallengeUserAttributePrefix(),o={};t&&Object.keys(t).forEach(function(e){o[s+e]=t[e]}),o.NEW_PASSWORD=e,o.USERNAME=this.username,this.client.makeUnauthenticatedRequest("respondToAuthChallenge",{ChallengeName:"NEW_PASSWORD_REQUIRED",ClientId:this.pool.getClientId(),ChallengeResponses:o,Session:this.Session},function(e,t){return e?n.onFailure(e):i.authenticateUserInternal(t,r,n)})}},{key:"getDeviceResponse",value:function(e){var t=this,n=new f["default"](this.deviceGroupKey,this.pool.getParanoia()),i=new k["default"],r={};r.USERNAME=this.username,r.DEVICE_KEY=this.deviceKey,r.SRP_A=n.getLargeAValue().toString(16),this.client.makeUnauthenticatedRequest("respondToAuthChallenge",{ChallengeName:"DEVICE_SRP_AUTH",ClientId:this.pool.getClientId(),ChallengeResponses:r},function(r,s){if(r)return e.onFailure(r);var o=s.ChallengeParameters,a=new c.BigInteger(o.SRP_B,16),l=new c.BigInteger(o.SALT,16),h=n.getPasswordAuthenticationKey(t.deviceKey,t.randomPassword,a,l),f=u.codec.base64.toBits(o.SECRET_BLOCK),d=new u.misc.hmac(h,u.hash.sha256);d.update(u.codec.utf8String.toBits(t.deviceGroupKey)),d.update(u.codec.utf8String.toBits(t.deviceKey)),d.update(f);var g=i.getNowString();d.update(u.codec.utf8String.toBits(g));var v=d.digest(),p=u.codec.base64.fromBits(v),y={};y.USERNAME=t.username,y.PASSWORD_CLAIM_SECRET_BLOCK=o.SECRET_BLOCK,y.TIMESTAMP=g,y.PASSWORD_CLAIM_SIGNATURE=p,y.DEVICE_KEY=t.deviceKey,t.client.makeUnauthenticatedRequest("respondToAuthChallenge",{ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:t.pool.getClientId(),ChallengeResponses:y,Session:s.Session},function(n,i){return n?e.onFailure(n):(t.signInUserSession=t.getCognitoUserSession(i.AuthenticationResult),t.cacheTokens(),e.onSuccess(t.signInUserSession))})})}},{key:"confirmRegistration",value:function(e,t,n){this.client.makeUnauthenticatedRequest("confirmSignUp",{ClientId:this.pool.getClientId(),ConfirmationCode:e,Username:this.username,ForceAliasCreation:t},function(e){return e?n(e,null):n(null,"SUCCESS")})}},{key:"sendCustomChallengeAnswer",value:function(e,t){var n=this,i={};i.USERNAME=this.username,i.ANSWER=e,this.client.makeUnauthenticatedRequest("respondToAuthChallenge",{ChallengeName:"CUSTOM_CHALLENGE",ChallengeResponses:i,ClientId:this.pool.getClientId(),Session:this.Session},function(e,i){if(e)return t.onFailure(e);var r=i.ChallengeName;return"CUSTOM_CHALLENGE"===r?(n.Session=i.Session,t.customChallenge(i.challengeParameters)):(n.signInUserSession=n.getCognitoUserSession(i.AuthenticationResult),n.cacheTokens(),t.onSuccess(n.signInUserSession))})}},{key:"sendMFACode",value:function(e,t){var n=this,i={};i.USERNAME=this.username,i.SMS_MFA_CODE=e,null!=this.deviceKey&&(i.DEVICE_KEY=this.deviceKey),this.client.makeUnauthenticatedRequest("respondToAuthChallenge",{ChallengeName:"SMS_MFA",ChallengeResponses:i,ClientId:this.pool.getClientId(),Session:this.Session},function(e,i){if(e)return t.onFailure(e);if(n.signInUserSession=n.getCognitoUserSession(i.AuthenticationResult),n.cacheTokens(),null==i.AuthenticationResult.NewDeviceMetadata)return t.onSuccess(n.signInUserSession);var r=new f["default"](n.pool.getUserPoolId().split("_")[1],n.pool.getParanoia());r.generateHashDevice(i.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,i.AuthenticationResult.NewDeviceMetadata.DeviceKey);var s={Salt:u.codec.base64.fromBits(u.codec.hex.toBits(r.getSaltDevices().toString(16))),PasswordVerifier:u.codec.base64.fromBits(u.codec.hex.toBits(r.getVerifierDevices().toString(16)))};n.verifierDevices=u.codec.base64.fromBits(r.getVerifierDevices()),n.deviceGroupKey=i.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,n.randomPassword=r.getRandomPassword(),n.client.makeUnauthenticatedRequest("confirmDevice",{DeviceKey:i.AuthenticationResult.NewDeviceMetadata.DeviceKey,AccessToken:n.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:s,DeviceName:navigator.userAgent},function(e,r){return e?t.onFailure(e):(n.deviceKey=i.AuthenticationResult.NewDeviceMetadata.DeviceKey,n.cacheDeviceKeyAndPassword(),r.UserConfirmationNecessary===!0?t.onSuccess(n.signInUserSession,r.UserConfirmationNecessary):t.onSuccess(n.signInUserSession))})})}},{key:"changePassword",value:function(e,t,n){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("changePassword",{PreviousPassword:e,ProposedPassword:t,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(e){return e?n(e,null):n(null,"SUCCESS")}):n(new Error("User is not authenticated"),null)}},{key:"enableMFA",value:function(e){if(null==this.signInUserSession||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);var t=[],n={DeliveryMedium:"SMS",AttributeName:"phone_number"};t.push(n),this.client.makeUnauthenticatedRequest("setUserSettings",{MFAOptions:t,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(t){return t?e(t,null):e(null,"SUCCESS")})}},{key:"disableMFA",value:function(e){if(null==this.signInUserSession||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);var t=[];this.client.makeUnauthenticatedRequest("setUserSettings",{MFAOptions:t,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(t){return t?e(t,null):e(null,"SUCCESS")})}},{key:"deleteUser",value:function(e){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("deleteUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(t){return t?e(t,null):e(null,"SUCCESS")}):e(new Error("User is not authenticated"),null)}},{key:"updateAttributes",value:function(e,t){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("updateUserAttributes",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserAttributes:e},function(e){return e?t(e,null):t(null,"SUCCESS")}):t(new Error("User is not authenticated"),null)}},{key:"getUserAttributes",value:function(e){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("getUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(t,n){if(t)return e(t,null);for(var i=[],r=0;r<n.UserAttributes.length;r++){var s={Name:n.UserAttributes[r].Name,Value:n.UserAttributes[r].Value},o=new E["default"](s);i.push(o)}return e(null,i)}):e(new Error("User is not authenticated"),null)}},{key:"deleteAttributes",value:function(e,t){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("deleteUserAttributes",{UserAttributeNames:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(e){return e?t(e,null):t(null,"SUCCESS")}):t(new Error("User is not authenticated"),null)}},{key:"resendConfirmationCode",value:function(e){this.client.makeUnauthenticatedRequest("resendConfirmationCode",{ClientId:this.pool.getClientId(),Username:this.username},function(t){return t?e(t,null):e(null,"SUCCESS")})}},{key:"getSession",value:function(e){if(null==this.username)return e(new Error("Username is null. Cannot retrieve a new session"),null);if(null!=this.signInUserSession&&this.signInUserSession.isValid())return e(null,this.signInUserSession);var t="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,n=t+".idToken",i=t+".accessToken",r=t+".refreshToken",s=this.localStorage;if(s.getItem(n)){var o=new p["default"]({IdToken:s.getItem(n)}),a=new g["default"]({AccessToken:s.getItem(i)}),u=new m["default"]({RefreshToken:s.getItem(r)}),c={IdToken:o,AccessToken:a,RefreshToken:u},l=new w["default"](c);if(l.isValid())return this.signInUserSession=l,e(null,this.signInUserSession);if(null==u.getToken())return e(new Error("Cannot retrieve a new session. Please authenticate."),null);this.refreshSession(u,e)}}},{key:"refreshSession",value:function(e,t){var n=this,i={};i.REFRESH_TOKEN=e.getToken();var r="CognitoIdentityServiceProvider."+this.pool.getClientId(),s=r+".LastAuthUser",o=this.localStorage;if(o.getItem(s)){this.username=o.getItem(s);var a=r+"."+this.username+".deviceKey";this.deviceKey=o.getItem(a),i.DEVICE_KEY=this.deviceKey}this.client.makeUnauthenticatedRequest("initiateAuth",{ClientId:this.pool.getClientId(),AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:i},function(i,r){if(i)return t(i,null);if(r){var s=r.AuthenticationResult;return Object.prototype.hasOwnProperty.call(s,"RefreshToken")||(s.RefreshToken=e.getToken()),n.signInUserSession=n.getCognitoUserSession(s),n.cacheTokens(),t(null,n.signInUserSession)}})}},{key:"cacheTokens",value:function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId(),t=e+"."+this.username+".idToken",n=e+"."+this.username+".accessToken",i=e+"."+this.username+".refreshToken",r=e+".LastAuthUser",s=this.localStorage;s.setItem(t,this.signInUserSession.getIdToken().getJwtToken()),s.setItem(n,this.signInUserSession.getAccessToken().getJwtToken()),s.setItem(i,this.signInUserSession.getRefreshToken().getToken()),s.setItem(r,this.username)}},{key:"cacheDeviceKeyAndPassword",value:function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,t=e+".deviceKey",n=e+".randomPasswordKey",i=e+".deviceGroupKey",r=this.localStorage;r.setItem(t,this.deviceKey),r.setItem(n,this.randomPassword),r.setItem(i,this.deviceGroupKey)}},{key:"getCachedDeviceKeyAndPassword",value:function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,t=e+".deviceKey",n=e+".randomPasswordKey",i=e+".deviceGroupKey",r=this.localStorage;r.getItem(t)&&(this.deviceKey=r.getItem(t),this.randomPassword=r.getItem(n),this.deviceGroupKey=r.getItem(i))}},{key:"clearCachedDeviceKeyAndPassword",value:function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,t=e+".deviceKey",n=e+".randomPasswordKey",i=e+".deviceGroupKey",r=this.localStorage;r.removeItem(t),r.removeItem(n),r.removeItem(i)}},{key:"clearCachedTokens",value:function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId(),t=e+"."+this.username+".idToken",n=e+"."+this.username+".accessToken",i=e+"."+this.username+".refreshToken",r=e+".LastAuthUser",s=this.localStorage;s.removeItem(t),s.removeItem(n),s.removeItem(i),s.removeItem(r)}},{key:"getCognitoUserSession",value:function(e){var t=new p["default"](e),n=new g["default"](e),i=new m["default"](e),r={IdToken:t,AccessToken:n,RefreshToken:i};return new w["default"](r)}},{key:"forgotPassword",value:function(e){this.client.makeUnauthenticatedRequest("forgotPassword",{ClientId:this.pool.getClientId(),Username:this.username},function(t,n){return t?e.onFailure(t):"function"==typeof e.inputVerificationCode?e.inputVerificationCode(n):e.onSuccess()})}},{key:"confirmPassword",value:function(e,t,n){this.client.makeUnauthenticatedRequest("confirmForgotPassword",{ClientId:this.pool.getClientId(),Username:this.username,ConfirmationCode:e,Password:t},function(e){return e?n.onFailure(e):n.onSuccess()})}},{key:"getAttributeVerificationCode",value:function(e,t){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("getUserAttributeVerificationCode",{AttributeName:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(e,n){return e?t.onFailure(e):t.inputVerificationCode(n)}):t(new Error("User is not authenticated"),null)}},{key:"verifyAttribute",value:function(e,t,n){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("verifyUserAttribute",{AttributeName:e,Code:t,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(e){return e?n.onFailure(e):n.onSuccess("SUCCESS")}):n(new Error("User is not authenticated"),null)}},{key:"getDevice",value:function(e){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("getDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey},function(t,n){return t?e.onFailure(t):e.onSuccess(n)}):e(new Error("User is not authenticated"),null)}},{key:"forgetDevice",value:function(e){var t=this;return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("forgetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey},function(n){return n?e.onFailure(n):(t.deviceKey=null,t.deviceGroupkey=null,t.randomPassword=null,t.clearCachedDeviceKeyAndPassword(),e.onSuccess("SUCCESS"))}):e(new Error("User is not authenticated"),null)}},{key:"setDeviceStatusRemembered",value:function(e){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("updateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"remembered"},function(t){return t?e.onFailure(t):e.onSuccess("SUCCESS")}):e(new Error("User is not authenticated"),null)}},{key:"setDeviceStatusNotRemembered",value:function(e){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("updateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"not_remembered"},function(t){return t?e.onFailure(t):e.onSuccess("SUCCESS")}):e(new Error("User is not authenticated"),null)}},{key:"listDevices",value:function(e,t,n){return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("listDevices",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),Limit:e,PaginationToken:t},function(e,t){return e?n.onFailure(e):n.onSuccess(t)}):n(new Error("User is not authenticated"),null)}},{key:"globalSignOut",value:function(e){var t=this;return null!=this.signInUserSession&&this.signInUserSession.isValid()?void this.client.makeUnauthenticatedRequest("globalSignOut",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(n){return n?e.onFailure(n):(t.clearCachedTokens(),e.onSuccess("SUCCESS"))}):e(new Error("User is not authenticated"),null)}},{key:"signOut",value:function(){this.signInUserSession=null,this.clearCachedTokens()}}]),e}();t["default"]=U},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.Name,r=t.Value;n(this,e),this.Name=i||"",this.Value=r||""}return i(e,[{key:"getValue",value:function(){return this.Value}},{key:"setValue",value:function(e){return this.Value=e,this}},{key:"getName",value:function(){return this.Name}},{key:"setName",value:function(e){return this.Name=e,this}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"toJSON",value:function(){return{Name:this.Name,Value:this.Value}}}]),e}();t["default"]=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.IdToken,r=t.RefreshToken,s=t.AccessToken;if(n(this,e),null==s||null==i)throw new Error("Id token and Access Token must be present.");this.idToken=i,this.refreshToken=r,this.accessToken=s}return i(e,[{key:"getIdToken",value:function(){return this.idToken}},{key:"getRefreshToken",value:function(){return this.refreshToken}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"isValid",value:function(){var e=Math.floor(new Date/1e3);return e<this.accessToken.getExpiration()&&e<this.idToken.getExpiration()}}]),e}();t["default"]=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=function(){function e(){n(this,e)}return i(e,[{key:"getNowString",value:function(){var e=new Date,t=s[e.getUTCDay()],n=r[e.getUTCMonth()],i=e.getUTCDate(),o=e.getUTCHours();o<10&&(o="0"+o);var a=e.getUTCMinutes();a<10&&(a="0"+a);var u=e.getUTCSeconds();u<10&&(u="0"+u);var c=e.getUTCFullYear(),l=t+" "+n+" "+i+" "+o+":"+a+":"+u+" UTC "+c;
return l}}]),e}();t["default"]=o},function(e,t,n){(function(){var e,i,r,s,o,a,u,c,l,h,f,d,g,v,p=function(e,t){function n(){this.constructor=e}for(var i in t)y.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},y={}.hasOwnProperty;g=n(31),d=n(2),f=n(30),v=n(20).sync,i="---.EMPTY_STRING.---",u=function(e){var t,n,i,r,s;for(r=d.readdirSync(e),s=[],t=0,n=r.length;t<n;t++)i=r[t],s.push(l(g.join(e,i)));return s},l=function(e){return d.statSync(e).isDirectory()?(u(e),d.rmdirSync(e)):d.unlinkSync(e)},c=function(e){var t;return t=""===e?i:e.toString()},o=function(e){function t(e){this.message=null!=e?e:"Unknown error.",null!=Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}return p(t,e),t.prototype.toString=function(){return this.name+": "+this.message},t}(Error),a=function(){function e(e,t,n,i,r){this.key=e,this.oldValue=t,this.newValue=n,this.url=i,this.storageArea=null!=r?r:"localStorage"}return e}(),s=function(){function e(t,n){if(this.key=t,this.index=n,!(this instanceof e))return new e(this.key,this.index)}return e}(),h=function(){var e;return e=function(){},e.prototype=Object.create(null),new e},r=function(e){function t(e,i){return this._location=e,this.quota=null!=i?i:5242880,this instanceof t?(this._location=g.resolve(this._location),null!=n[this._location]?n[this._location]:(this.length=0,this._bytesInUse=0,this._keys=[],this._metaKeyMap=h(),this._eventUrl="pid:"+process.pid,this._init(),this._QUOTA_EXCEEDED_ERR=o,n[this._location]=this,n[this._location])):new t(this._location,this.quota)}var n;return p(t,e),n={},t.prototype._init=function(){var e,t,n,i,r,o,a,u;try{if(u=d.statSync(this._location),null!=u&&!u.isDirectory())throw new Error("A file exists at the location '"+this._location+"' when trying to create/open localStorage");for(this._bytesInUse=0,this.length=0,n=d.readdirSync(this._location),r=i=0,a=n.length;i<a;r=++i)o=n[r],t=decodeURIComponent(o),this._keys.push(t),e=new s(o,r),this._metaKeyMap[t]=e,u=this._getStat(o),null!=(null!=u?u.size:void 0)&&(e.size=u.size,this._bytesInUse+=u.size);this.length=n.length}catch(c){d.mkdirSync(this._location)}},t.prototype.setItem=function(e,t){var n,i,r,u,l,h,d,p,y,m;if(l=f.EventEmitter.listenerCount(this,"storage"),p=null,l&&(p=this.getItem(e)),e=c(e),n=encodeURIComponent(e),u=g.join(this._location,n),y=t.toString(),m=y.length,h=this._metaKeyMap[e],r=!!h,d=r?h.size:0,this._bytesInUse-d+m>this.quota)throw new o;if(v(u,y,"utf8"),r||(h=new s(n,this._keys.push(e)-1),h.size=m,this._metaKeyMap[e]=h,this.length+=1,this._bytesInUse+=m),l)return i=new a(e,p,t,this._eventUrl),this.emit("storage",i)},t.prototype.getItem=function(e){var t,n;return e=c(e),n=this._metaKeyMap[e],n?(t=g.join(this._location,n.key),d.readFileSync(t,"utf8")):null},t.prototype._getStat=function(e){var t;e=c(e),t=g.join(this._location,encodeURIComponent(e));try{return d.statSync(t)}catch(n){return null}},t.prototype.removeItem=function(e){var t,n,i,r,s,o,u,h,d;if(e=c(e),o=this._metaKeyMap[e]){i=f.EventEmitter.listenerCount(this,"storage"),u=null,i&&(u=this.getItem(e)),delete this._metaKeyMap[e],this.length-=1,this._bytesInUse-=o.size,n=g.join(this._location,o.key),this._keys.splice(o.index,1),h=this._metaKeyMap;for(r in h)d=h[r],s=this._metaKeyMap[r],s.index>o.index&&(s.index-=1);if(l(n),i)return t=new a(e,u,null,this._eventUrl),this.emit("storage",t)}},t.prototype.key=function(e){return this._keys[e]},t.prototype.clear=function(){var e;if(u(this._location),this._metaKeyMap=h(),this._keys=[],this.length=0,this._bytesInUse=0,f.EventEmitter.listenerCount(this,"storage"))return e=new a(null,null,null,this._eventUrl),this.emit("storage",e)},t.prototype._getBytesInUse=function(){return this._bytesInUse},t.prototype._deleteLocation=function(){return delete n[this._location],l(this._location),this._metaKeyMap={},this._keys=[],this.length=0,this._bytesInUse=0},t}(f.EventEmitter),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return p(t,e),t.prototype.setItem=function(e,n){var i;return i=JSON.stringify(n),t.__super__.setItem.call(this,e,i)},t.prototype.getItem=function(e){return JSON.parse(t.__super__.getItem.call(this,e))},t}(r),t.LocalStorage=r,t.JSONStorage=e,t.QUOTA_EXCEEDED_ERR=o}).call(this)},function(e,t,n){"use strict";function i(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var t={__proto__:e.__proto__};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}var r=n(2);e.exports=i(r)},function(e,t){function n(){var e,t=Array.prototype.slice.call(arguments),n=null;return"object"==typeof t[0]?(n=t.shift(),e=t.shift(),"string"==typeof e&&(e=n[e])):e=t.shift(),function(i){e.apply(n,t.concat(i))}}e.exports=n},function(e,t){e.exports=require("util")},function(e,t){e.exports=i},function(e,t){e.exports=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e);var i=t||{},r=i.ValidationData,s=i.Username,o=i.Password;this.validationData=r||[],this.username=s,this.password=o}return i(e,[{key:"getUsername",value:function(){return this.username}},{key:"getPassword",value:function(){return this.password}},{key:"getValidationData",value:function(){return this.validationData}}]),e}();t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(11),a=n(15),u=i(a),c=n(7),l=i(c),h=function(){function e(t){r(this,e);var n=t||{},i=n.UserPoolId,s=n.ClientId,a=n.Paranoia;if(!i||!s)throw new Error("Both UserPoolId and ClientId are required.");if(!/^[\w-]+_.+$/.test(i))throw new Error("Invalid UserPoolId format.");var c=i.split("_")[0];this.userPoolId=i,this.clientId=s,this.paranoia=a||0,this.client=new u["default"]({apiVersion:"2016-04-19",region:c}),this.localStorage=new o.LocalStorage("./.scratch")}return s(e,[{key:"getUserPoolId",value:function(){return this.userPoolId}},{key:"getClientId",value:function(){return this.clientId}},{key:"getParanoia",value:function(){return this.paranoia}},{key:"setParanoia",value:function(e){this.paranoia=e}},{key:"signUp",value:function(e,t,n,i,r){var s=this;this.client.makeUnauthenticatedRequest("signUp",{ClientId:this.clientId,Username:e,Password:t,UserAttributes:n,ValidationData:i},function(t,n){if(t)return r(t,null);var i={Username:e,Pool:s},o={user:new l["default"](i),userConfirmed:n.UserConfirmed};return r(null,o)})}},{key:"getCurrentUser",value:function(){var e="CognitoIdentityServiceProvider."+this.clientId+".LastAuthUser",t=localStorage,n=t.getItem(e);if(n){var i={Username:n,Pool:this};return new l["default"](i)}return null}}]),e}();t["default"]=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(17);Object.defineProperty(t,"AuthenticationDetails",{enumerable:!0,get:function(){return i(r)["default"]}});var s=n(3);Object.defineProperty(t,"AuthenticationHelper",{enumerable:!0,get:function(){return i(s)["default"]}});var o=n(4);Object.defineProperty(t,"CognitoAccessToken",{enumerable:!0,get:function(){return i(o)["default"]}});var a=n(5);Object.defineProperty(t,"CognitoIdToken",{enumerable:!0,get:function(){return i(a)["default"]}});var u=n(6);Object.defineProperty(t,"CognitoRefreshToken",{enumerable:!0,get:function(){return i(u)["default"]}});var c=n(7);Object.defineProperty(t,"CognitoUser",{enumerable:!0,get:function(){return i(c)["default"]}});var l=n(8);Object.defineProperty(t,"CognitoUserAttribute",{enumerable:!0,get:function(){return i(l)["default"]}});var h=n(18);Object.defineProperty(t,"CognitoUserPool",{enumerable:!0,get:function(){return i(h)["default"]}});var f=n(9);Object.defineProperty(t,"CognitoUserSession",{enumerable:!0,get:function(){return i(f)["default"]}});var d=n(10);Object.defineProperty(t,"DateHelper",{enumerable:!0,get:function(){return i(d)["default"]}})},function(e,t,n){(function(t){"use strict";function i(){for(var e=new o,t=0;t<arguments.length;++t)e.hash(""+arguments[t]);return e.result()}var r=n(21),s=n(27).chain,o=n(24),a=Object.assign||n(14)._extend,u=0,c=function(e){return e+"."+i(t,process.pid,++u)};e.exports=function(e,t,n,i){function o(){s([[r,r.writeFile,u,t,n.encoding||"utf8"],n.mode&&[r,r.chmod,u,n.mode],n.chown&&[r,r.chown,u,n.chown.uid,n.chown.gid],[r,r.rename,u,e]],function(e){e?r.unlink(u,function(){i(e)}):i()})}n instanceof Function&&(i=n,n=null),n||(n={});var u=c(e);return n.mode&&n.chmod?o():r.stat(e,function(e,t){return n=a({},n),e||!t||n.mode||(n.mode=t.mode),!e&&t&&!n.chown&&process.getuid&&(n.chown={uid:t.uid,gid:t.gid}),o()})},e.exports.sync=function(e,t,n){n||(n={});var i=c(e);try{if(!n.mode||!n.chmod)try{var s=r.statSync(e);n=a({},n),n.mode||(n.mode=s.mode),!n.chown&&process.getuid&&(n.chown={uid:s.uid,gid:s.gid})}catch(o){}r.writeFileSync(i,t,n.encoding||"utf8"),n.chown&&r.chownSync(i,n.chown.uid,n.chown.gid),n.mode&&r.chmodSync(i,n.mode),r.renameSync(i,e)}catch(u){try{r.unlinkSync(i)}catch(l){}throw u}}}).call(t,"/index.js")},function(e,t,n){function i(){}function r(e){function t(e,t,n){function i(e,t,n){return m(e,t,function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?("function"==typeof n&&n.apply(this,arguments),o()):s([i,[e,t,n]])})}return"function"==typeof t&&(n=t,t=null),i(e,t,n)}function n(e,t,n,i){function r(e,t,n,i){return S(e,t,n,function(a){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?("function"==typeof i&&i.apply(this,arguments),o()):s([r,[e,t,n,i]])})}return"function"==typeof n&&(i=n,n=null),r(e,t,n,i)}function i(e,t,n,i){function r(e,t,n,i){return w(e,t,n,function(a){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?("function"==typeof i&&i.apply(this,arguments),o()):s([r,[e,t,n,i]])})}return"function"==typeof n&&(i=n,n=null),r(e,t,n,i)}function a(e,t,n){function i(e,t){t&&t.sort&&t.sort(),!e||"EMFILE"!==e.code&&"ENFILE"!==e.code?("function"==typeof n&&n.apply(this,arguments),o()):s([l,[r]])}var r=[e];return"function"!=typeof t?r.push(t):n=t,r.push(i),l(r)}function l(t){return C.apply(e,t)}function h(e,t){return this instanceof h?(A.apply(this,arguments),this):h.apply(Object.create(h.prototype),arguments)}function f(){var e=this;y(e.path,e.flags,e.mode,function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())})}function d(e,t){return this instanceof d?(E.apply(this,arguments),this):d.apply(Object.create(d.prototype),arguments)}function g(){var e=this;y(e.path,e.flags,e.mode,function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))})}function v(e,t){return new h(e,t)}function p(e,t){return new d(e,t)}function y(e,t,n,i){function r(e,t,n,i){return U(e,t,n,function(a,u){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?("function"==typeof i&&i.apply(this,arguments),o()):s([r,[e,t,n,i]])})}return"function"==typeof n&&(i=n,n=null),r(e,t,n,i)}u(e),e.gracefulify=r,e.FileReadStream=h,e.FileWriteStream=d,e.createReadStream=v,e.createWriteStream=p;var m=e.readFile;e.readFile=t;var S=e.writeFile;e.writeFile=n;var w=e.appendFile;w&&(e.appendFile=i);var C=e.readdir;if(e.readdir=a,"v0.8"===process.version.substr(0,4)){var k=c(e);h=k.ReadStream,d=k.WriteStream}var A=e.ReadStream;h.prototype=Object.create(A.prototype),h.prototype.open=f;var E=e.WriteStream;d.prototype=Object.create(E.prototype),d.prototype.open=g,e.ReadStream=h,e.WriteStream=d;var U=e.open;return e.open=y,e}function s(e){f("ENQUEUE",e[0].name,e[1]),l.push(e)}function o(){var e=l.shift();e&&(f("RETRY",e[0].name,e[1]),e[0].apply(null,e[1]))}var a=n(2),u=n(23),c=n(22),l=[],h=n(14),f=i;h.debuglog?f=h.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(f=function(){var e=h.format.apply(h,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){f(l),n(28).equal(l.length,0)}),e.exports=r(n(12)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&(e.exports=r(a)),e.exports.close=a.close=function(e){return function(t,n){return e.call(a,t,function(e){e||o(),"function"==typeof n&&n.apply(this,arguments)})}}(a.close),e.exports.closeSync=a.closeSync=function(e){return function(t){var n=e.apply(a,arguments);return o(),n}}(a.closeSync)},function(e,t,n){function i(e){function t(n,i){if(!(this instanceof t))return new t(n,i);r.call(this);var s=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,i=i||{};for(var o=Object.keys(i),a=0,u=o.length;a<u;a++){var c=o[a];this[c]=i[c]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}return null!==this.fd?void process.nextTick(function(){s._read()}):void e.open(this.path,this.flags,this.mode,function(e,t){return e?(s.emit("error",e),void(s.readable=!1)):(s.fd=t,s.emit("open",t),void s._read())})}function n(t,i){if(!(this instanceof n))return new n(t,i);r.call(this),this.path=t,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var s=Object.keys(i),o=0,a=s.length;o<a;o++){var u=s[o];this[u]=i[u]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}return{ReadStream:t,WriteStream:n}}var r=n(32).Stream;e.exports=i},function(e,t,n){function i(e){g.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&r(e),e.lutimes||s(e),e.chown=u(e.chown),e.fchown=u(e.fchown),e.lchown=u(e.lchown),e.chmod=o(e.chmod),e.fchmod=o(e.fchmod),e.lchmod=o(e.lchmod),e.chownSync=c(e.chownSync),e.fchownSync=c(e.fchownSync),e.lchownSync=c(e.lchownSync),e.chmodSync=a(e.chmodSync),e.fchmodSync=a(e.fchmodSync),e.lchmodSync=a(e.lchmodSync),e.stat=l(e.stat),e.fstat=l(e.fstat),e.lstat=l(e.lstat),e.statSync=h(e.statSync),e.fstatSync=h(e.fstatSync),e.lstatSync=h(e.lstatSync),e.lchmod||(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){}),e.lchown||(e.lchown=function(e,t,n,i){i&&process.nextTick(i)},e.lchownSync=function(){}),"win32"===process.platform&&(e.rename=function(e){return function(t,n,i){var r=Date.now();e(t,n,function s(o){return o&&("EACCES"===o.code||"EPERM"===o.code)&&Date.now()-r<1e3?e(t,n,s):void(i&&i(o))})}}(e.rename)),e.read=function(t){return function(n,i,r,s,o,a){var u;if(a&&"function"==typeof a){var c=0;u=function(l,h,f){return l&&"EAGAIN"===l.code&&c<10?(c++,t.call(e,n,i,r,s,o,u)):void a.apply(this,arguments)}}return t.call(e,n,i,r,s,o,u)}}(e.read),e.readSync=function(t){return function(n,i,r,s,o){for(var a=0;;)try{return t.call(e,n,i,r,s,o)}catch(u){if("EAGAIN"===u.code&&a<10){a++;continue}throw u}}}(e.readSync)}function r(e){e.lchmod=function(t,n,i){e.open(t,g.O_WRONLY|g.O_SYMLINK,n,function(t,r){return t?void(i&&i(t)):void e.fchmod(r,n,function(t){e.close(r,function(e){i&&i(t||e)})})})},e.lchmodSync=function(t,n){var i,r=e.openSync(t,g.O_WRONLY|g.O_SYMLINK,n),s=!0;try{i=e.fchmodSync(r,n),s=!1}finally{if(s)try{e.closeSync(r)}catch(o){}else e.closeSync(r)}return i}}function s(e){g.hasOwnProperty("O_SYMLINK")?(e.lutimes=function(t,n,i,r){e.open(t,g.O_SYMLINK,function(t,s){return t?void(r&&r(t)):void e.futimes(s,n,i,function(t){e.close(s,function(e){r&&r(t||e)})})})},e.lutimesSync=function(t,n,i){var r,s=e.openSync(t,g.O_SYMLINK),o=!0;try{r=e.futimesSync(s,n,i),o=!1}finally{if(o)try{e.closeSync(s)}catch(a){}else e.closeSync(s)}return r}):(e.lutimes=function(e,t,n,i){i&&process.nextTick(i)},e.lutimesSync=function(){})}function o(e){return e?function(t,n,i){return e.call(d,t,n,function(e){f(e)&&(e=null),i&&i.apply(this,arguments)})}:e}function a(e){return e?function(t,n){try{return e.call(d,t,n)}catch(i){if(!f(i))throw i}}:e}function u(e){return e?function(t,n,i,r){return e.call(d,t,n,i,function(e){f(e)&&(e=null),r&&r.apply(this,arguments)})}:e}function c(e){return e?function(t,n,i){try{return e.call(d,t,n,i)}catch(r){if(!f(r))throw r}}:e}function l(e){return e?function(t,n){return e.call(d,t,function(e,t){return t?(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296),void(n&&n.apply(this,arguments))):n.apply(this,arguments)})}:e}function h(e){return e?function(t){var n=e.call(d,t);return n.uid<0&&(n.uid+=4294967296),n.gid<0&&(n.gid+=4294967296),n}:e}function f(e){if(!e)return!0;if("ENOSYS"===e.code)return!0;var t=!process.getuid||0!==process.getuid();return!(!t||"EINVAL"!==e.code&&"EPERM"!==e.code)}var d=n(12),g=n(29),v=process.cwd,p=null;process.cwd=function(){return p||(p=v.call(process)),p};try{process.cwd()}catch(y){}var m=process.chdir;process.chdir=function(e){p=null,m.call(process,e)},e.exports=i},function(e,t,n){/**
	 * @preserve
	 * JS Implementation of incremental MurmurHash3 (r150) (as of May 10, 2013)
	 *
	 * @author <a href="mailto:jensyt@gmail.com">Jens Taylor</a>
	 * @see http://github.com/homebrewing/brauhaus-diff
	 * @author <a href="mailto:gary.court@gmail.com">Gary Court</a>
	 * @see http://github.com/garycourt/murmurhash-js
	 * @author <a href="mailto:aappleby@gmail.com">Austin Appleby</a>
	 * @see http://sites.google.com/site/murmurhash/
	 */
!function(){function t(e,i){var r=this instanceof t?this:n;if(r.reset(i),"string"==typeof e&&e.length>0&&r.hash(e),r!==this)return r}var n;t.prototype.hash=function(e){var t,n,i,r,s;switch(s=e.length,this.len+=s,n=this.k1,i=0,this.rem){case 0:n^=s>i?65535&e.charCodeAt(i++):0;case 1:n^=s>i?(65535&e.charCodeAt(i++))<<8:0;case 2:n^=s>i?(65535&e.charCodeAt(i++))<<16:0;case 3:n^=s>i?(255&e.charCodeAt(i))<<24:0,n^=s>i?(65280&e.charCodeAt(i++))>>8:0}if(this.rem=s+this.rem&3,s-=this.rem,s>0){for(t=this.h1;n=11601*n+3432906752*(65535&n)&4294967295,n=n<<15|n>>>17,n=13715*n+461832192*(65535&n)&4294967295,t^=n,t=t<<13|t>>>19,t=5*t+3864292196&4294967295,!(i>=s);)n=65535&e.charCodeAt(i++)^(65535&e.charCodeAt(i++))<<8^(65535&e.charCodeAt(i++))<<16,r=e.charCodeAt(i++),n^=(255&r)<<24^(65280&r)>>8;switch(n=0,this.rem){case 3:n^=(65535&e.charCodeAt(i+2))<<16;case 2:n^=(65535&e.charCodeAt(i+1))<<8;case 1:n^=65535&e.charCodeAt(i)}this.h1=t}return this.k1=n,this},t.prototype.result=function(){var e,t;return e=this.k1,t=this.h1,e>0&&(e=11601*e+3432906752*(65535&e)&4294967295,e=e<<15|e>>>17,e=13715*e+461832192*(65535&e)&4294967295,t^=e),t^=this.len,t^=t>>>16,t=51819*t+2246770688*(65535&t)&4294967295,t^=t>>>13,t=44597*t+3266445312*(65535&t)&4294967295,t^=t>>>16,t>>>0},t.prototype.reset=function(e){return this.h1="number"==typeof e?e:0,this.rem=this.k1=this.len=0,this},n=new t,e.exports=t}()},function(e,t){function n(){function e(c){c&&!o&&(o=c);for(var l=arguments.length,h=1;h<l;h++)void 0!==arguments[h]&&(s[h-1]=(s[h-1]||[]).concat(arguments[h]));if(n.length>a){var f=n.slice(a);u+=(n.length-a)*r,a=n.length,process.nextTick(function(){f.forEach(function(n){t.forEach(function(t){t(n,e)})})})}0===--u&&i.apply(null,[o].concat(s))}var t=Array.prototype.slice.call(arguments),n=t.shift()||[],i=t.pop();if("function"!=typeof i)throw new Error("No callback provided to asyncMap");if(!n)return i(null,[]);Array.isArray(n)||(n=[n]);var r=t.length,s=[],o=null,a=n.length,u=a*r;return u?void n.forEach(function(n){t.forEach(function(t){t(n,e)})}):i(null,[])}e.exports=n},function(e,t,n){function i(e,t){var n=[];!function s(o,a){return o>=a?t(null,n):(Array.isArray(e[o])&&(e[o]=r.apply(null,e[o].map(function(e){return e===i.first?n[0]:e===i.last?n[n.length-1]:e}))),e[o]?void e[o](function(e,i){return e?t(e,n):(void 0!==i&&(n=n.concat(i)),void s(o+1,a))}):s(o+1,a))}(0,e.length)}e.exports=i;var r=n(13);i.first={},i.last={}},function(e,t,n){t.asyncMap=n(25),t.bindActor=n(13),t.chain=n(26)},function(e,t){e.exports=require("assert")},function(e,t){e.exports=require("constants")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("stream")}])});
//# sourceMappingURL=amazon-cognito-identity.min.js.map